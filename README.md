# TumInvasion-BM: Simulation of the rupture of the basement membrane by the effect of tumor cells


## Description
This repository contains the codes for the simulations of the rupture of the basement membrane (BM).
The codes were used for the article: Luís Almeida, Alexandre Poulain, Albin Dr Pourtier, Chiara Villa. Mathematical modelling of the contribution of senescent fibroblasts to basement membrane digestion during carcinoma invasion. 2024. ⟨hal-04574340⟩.

In this work, BM rupture happens because of the effect of digestive enzymes activated by the tumor cells.
These active enzymes are produced in inactive form by the senescent fibroblasts (SFs).

The structure of the repository is the following:
- parameters.m: contains the parameters values.
- reduced_system/: contains codes for the simulations of the reduced system.
- full_system/: contains the scripts and functions to simulate the full system of equations
- sensitivity_analysis/: this folder contains the cripts and function to run the sensitivity analysis. To run the main script, please see the instructions at the beginning of SFs_SensitivityAnalysis.m

All the scripts and functions have been executed using MATLAB version '9.11.0.1769968 (R2021b)'. 
The SAFE package used to perform our sensituvity analysis was the release SAFEmatlab v1.2. 

## How to use
### Simulating the model
For the reduced and full systems, the code is run from the main scripts "script_reduced_system.m" and "script_full_system.m" respectively.
In the beginning of these scripts, the user must choose:
- the dimension of the conjunctive tissue dim = 1 or 2. The BM will have the dimension dim-1. 
- the test: if test = 1 it corresponds to the healthy test case (no tumor cells nor SF), 
test = 2 corresponds to the tumor test case (tumor cells in the BM and no SF), 
test = 3 corresponds to the tumor + SF case (positive tumor cells density and SF in the conjunctive)

The scripts are composed of the following sections: 
- discretization (space and time)
- parameter values (in this section there is a call to the parameters.m function). 
After this call, there is the part to prepare the source terms and to include the effect of the SFs in the model. 
- initial conditions. Here is a call to the initial_conditions.m file. It prepares the vectors corresponding the initial concentrations of enzymes and densities.
- Stability test for the reduced system. It tests if the stability of the ODE system (see article's supplementary information)
- Call the main function to solve the system. 

If you want to obtain plots of the quantities, run the plot_figs.m script after the completion of the main script. 
At the beginning of the plot_figs.m script, you can select if you want to save the figures (to the directory specified in "plotpath" variable)


### How to replicate the images of the article

- Figures 3 and S1 can be replicated running the script "reduced_system/plot_steady_state.m".
- Figures 4 and 5 can be replicated using script "Script_Figure_4_5.m"
- Figure 6 can be obtained using the script "full_system/Script_FIgure_6.m"

- as sensitivity analysis depends on a random choice of the parameter values with implemented bounds, the script "sensitivity_analysis/SFs_SensitivityAnalysis.m" will not reproduce exactly the figures 7 and 8. However, similar conclusions can be made from the figures generated by the script. 

- Supplementary figures 3,4 and 5 can be obtained from the script "Plot_Figures_supplementaries.m", please select the figure you want to obtain changing the parameter "Figure_to_replicate" at the beginning of the script. You need to generate the data first from the script "Script_Figure_4_5.m"



## Authors
Alexandre Poulain and Chiara Villa. 

## How to cite
Please cite our article if you are using this code: Luís Almeida, Alexandre Poulain, Albin Dr Pourtier, Chiara Villa. Mathematical modelling of the contribution of senescent fibroblasts to basement membrane digestion during carcinoma invasion. 2024. ⟨hal-04574340⟩
